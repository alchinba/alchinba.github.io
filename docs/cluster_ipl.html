<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Dimash Alchinbayev - Cluster Analysis IPL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Dimash Alchinbayev</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#instroduction" id="toc-instroduction" class="nav-link active" data-scroll-target="#instroduction">Instroduction</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">Data Exploration</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering">Clustering</a></li>
  <li><a href="#parallel-coordinate-plot-for-cluster-interpretation" id="toc-parallel-coordinate-plot-for-cluster-interpretation" class="nav-link" data-scroll-target="#parallel-coordinate-plot-for-cluster-interpretation">Parallel Coordinate Plot for Cluster interpretation</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Cluster Analysis IPL</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="instroduction" class="level2">
<h2 class="anchored" data-anchor-id="instroduction">Instroduction</h2>
<p>Here I explore the performance of the Indian Premier League batsmen in cricket. The dataset includes the popular performance metrics for 92 players: Average, Total Runs, Strike Rate, Hundreds, Fifties, Fours, Sixes, and salaries. In short, the higher the value of the metrics, the better a batsman is. The Average reflects the total number of runs scored divided by the number of innings in a season. The SR is calculated by dividing the number of runs scored by the number of balls faced and then multiplying by 100. It shows if a batsman scores runs at a faster pace. The rest of the metrics reflect the numbers of times a player scored, for example, fifty or more runs per inning. An inning is a team’s turn to bat.</p>
<p>I am analyzing the correspondence of the players’ pay and their performance. I am going to look at SR and Avg. These two metrics should be of critical meaning since they signal the relative performance. In other words, if we compare two player’s SR (Strikes Rate) rather than absolute scores, we can observe their ability to score high (runs per 100 balls faced). This is more clear than absolute numbers of runs, since batsmen have to be called to face the ball, which can skew the final number. The same could be said about Avg.</p>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"The Indian Premier League Supplemental Data.xlsx"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet =</span> <span class="st">"Sheet1"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"skip"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...1`</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co">#describe()</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools) <span class="co">#descr()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here is a quick preview of the dataset:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Cricket_Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
   ...1 Player       Team   Runs   Avg    SR Hundreds Fifties Fours Sixes Salary
  &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1 AB&nbsp;de Villi… Roya…   442  44.2 154          0       5    31    26  1.72 
2     2 Ajinkya&nbsp;Rah… Raja…   393  32.8 138.         1       1    45     9  0.625
3     3 Akshdeep&nbsp;Na… Roya…    61  12.2 107.         0       0     5     2  0.514
4     4 Ambati&nbsp;Rayu… Chen…   282  23.5  93.1        0       1    20     7  0.344
5     5 Andre&nbsp;Russe… Kolk…   510  56.7 205.         0       4    31    52  1.33 
6     6 Axar&nbsp;Patel   Roya…   110  18.3 125          0       0    10     3  0.714</code></pre>
</div>
</div>
<p>Here we can see a table of descriptive statistics for the performance metrics:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">descr</span>(Cricket_Data[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)],  <span class="co">#without ...1, Player, Team</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics  
Cricket_Data  
N: 70  

                   Mean   Std.Dev   Median     Min      Max
-------------- -------- --------- -------- ------- --------
           Avg    28.58     14.89    27.07    3.60    83.20
       Fifties     1.49      1.73     1.00    0.00     8.00
         Fours    22.40     16.84    19.00    1.00    64.00
      Hundreds     0.09      0.28     0.00    0.00     1.00
          Runs   249.26    168.75   216.50   12.00   692.00
        Salary     0.91      0.67     0.70    0.03     2.66
         Sixes    10.51      9.57     8.00    0.00    52.00
            SR   133.12     25.18   133.31   63.15   204.81</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:psych':

    %+%, alpha</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages
───────────────────────────────────────
tidyverse 1.3.2 ──</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>✔ tibble  3.1.8     ✔ dplyr   1.1.0
✔ tidyr   1.2.0     ✔ stringr 1.4.0
✔ readr   2.1.2     ✔ forcats 0.5.1
✔ purrr   1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ ggplot2::%+%()   masks psych::%+%()
✖ ggplot2::alpha() masks psych::alpha()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ tibble::view()   masks summarytools::view()</code></pre>
</div>
</div>
<p>Here I plot the Salary against the Avg.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Avg, <span class="at">y=</span>Salary)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that generally a higher Avg is associated with higher salary.</p>
<p>I now plot SR against the Salary.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Salary)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we can observe almost no visual relationship between the two.</p>
<p>I then build a simple correlation matrix to see which metrics are highly correlated with salary:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Salary) <span class="sc">|&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Salary))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Salary
Salary   1.0000000
Runs     0.3234302
Avg      0.2919955
Fifties  0.2900521
Fours    0.2550323
Sixes    0.2468059
Hundreds 0.2331481
SR       0.1055668</code></pre>
</div>
</div>
<p>We observe a positive but weak correlation between Salary and most performance metrics. SR, however, has the lowest correlation.</p>
<p>I generate boxplots for both metrics with outliers named, so we can see the distribution of the data and the names of the players who score the highest. The limitation would be that we do not see other players. This can be overcome by sorting the data by our metrics and see who ends up above the mean or another threshold.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.4</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(Cricket_Data, Avg<span class="sc">&gt;</span><span class="dv">60</span>), <span class="fu">aes</span>(<span class="at">label =</span> Player)) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Boxplot for Avg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/Avg boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that these two players have the highest Avg.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>SR)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.4</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(Cricket_Data, SR<span class="sc">&gt;</span><span class="dv">180</span>), <span class="fu">aes</span>(<span class="at">label =</span> Player))<span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Boxplot for SR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/SR boxplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The other two have the highest SR.</p>
<p>I know plot Avg vs SR, to see the distribution of players according to these metrics.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Player), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot of the Players' Avg vs SR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/plotting SR vs Avg-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we can identify the players with the highest combination of SR and Avg metrics. The closer the player is to the top right corner, the better performance he has, and reversely the closer he is to the bottom left, the worse their performance is. We can also observe that relatively few players have Avg above 40.</p>
</section>
<section id="clustering" class="level2">
<h2 class="anchored" data-anchor-id="clustering">Clustering</h2>
<p>I then perform cluster analysis to discover any subgroups within the dataset. I use a clustering method called kmeans, which uses the Euclidean distances to subset our datapoints.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tidyverse)  # data manipulation</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)    <span class="co"># clustering algorithms</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># clustering algorithms &amp; visualization (fviz...)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
</div>
<p>I remove the variables Team and “…1” in the data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">select</span>(Cricket_Data, <span class="sc">-</span>Team, <span class="sc">-</span><span class="st">"...1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I set the Players’ names as rownames to label the datapoints for better vizualization.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> <span class="fu">column_to_rownames</span>(df, <span class="st">"Player"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I check clustering without scaling the data first.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>k4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df2, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k4<span class="fl">.2</span>, <span class="at">data =</span> df2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/checking clusters without scaling-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see, unscaled data overlaps signficantly.</p>
<p>I standardize the data for better clustering using scale() function.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(df2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I check the scaling:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check scaling. Mean should be 0 and Std 1.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">descr</span>(df3, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics  
df3  
N: 70  

                 Mean   Std.Dev   Median     Min    Max
-------------- ------ --------- -------- ------- ------
           Avg   0.00      1.00    -0.10   -1.68   3.67
       Fifties   0.00      1.00    -0.28   -0.86   3.76
         Fours   0.00      1.00    -0.20   -1.27   2.47
      Hundreds   0.00      1.00    -0.30   -0.30   3.24
          Runs   0.00      1.00    -0.19   -1.41   2.62
        Salary   0.00      1.00    -0.31   -1.32   2.60
         Sixes   0.00      1.00    -0.26   -1.10   4.33
            SR   0.00      1.00     0.01   -2.78   2.85</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I visualize initial kmeans clustering with 2 clusters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k2, <span class="at">data =</span> df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I plot Clusters by Teams to see if it produces any insight.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="at">object =</span> <span class="fu">list</span>(<span class="at">data =</span> df3, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster =</span> Cricket_Data<span class="sc">$</span>Team),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.clust.cent =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/clustering with Teams-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that Players cannot be meaningfully clustered by Teams. That is, the teams do not differ from each other based on the metrics presented.</p>
<p>I perform Elbow method to identify optimal number of Clusters.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/algo for Elbow method-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I use factoextra functions for better visualization.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df3, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">190</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">230</span>, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"brown"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/Elbow Method with fviz_nbclust-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#should check if k=5 is good too</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This chart shows that Total Within Sum of Squares drop rate decreases after 4 and even more so after 5 clusters. We can evaluate both cases and use Silhouette Method for further investigation.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k4, <span class="at">data =</span> df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/Plot for 4 Clusters with fviz-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Clusters are almost not overlapping. Cluster 1 is quite big compared to others.</p>
<p>Here are the cluster centers (means) and sizes of clusters.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>k4<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Runs        Avg          SR   Hundreds    Fifties      Fours      Sixes
1 -0.8138651 -0.5593812 -0.32277994 -0.3039913 -0.7165009 -0.7826572 -0.6495237
2  1.2370084  1.5176928  1.33963042 -0.3039913  1.0654740  0.5896937  2.2273208
3  0.6760145  0.2087239  0.06149259 -0.3039913  0.6810246  0.8186736  0.3293470
4  1.4157758  1.2012910  0.43562184  3.2425739  0.9693617  1.3713348  0.6253612
       Salary
1 -0.26225776
2  1.06586416
3 -0.05845941
4  0.75599997</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k4<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37  6 21  6</code></pre>
</div>
</div>
<p>Here is the plot for Average Silhouette Method. ASM determines how well each object lies within its cluster. A high average silhouette width signals a good clustering.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df3, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">5</span>, </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/silhouette with fviz-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(v = 5, col = "red", lty = "dashed")</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">#seems k=5 is the second highest </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>According to the ASM plot, k=5 should be more optimal than k=4. I perform a new cluster analysis using 5 centers.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k5, <span class="at">data =</span> df3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/k5 analysis with 5 clusters-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here are the Cluster centers which we can interpret as means for each cluster (data is scaled).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>k5<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Runs        Avg          SR   Hundreds    Fifties      Fours      Sixes
1  0.7470225  0.2122767 -0.04890149 -0.3039913  0.7518443  0.9510921  0.2651953
2 -0.5874998 -0.0488647  0.61959027 -0.3039913 -0.6193189 -0.6313657 -0.2934097
3  1.2370084  1.5176928  1.33963042 -0.3039913  1.0654740  0.5896937  2.2273208
4  1.4157758  1.2012910  0.43562184  3.2425739  0.9693617  1.3713348  0.6253612
5 -0.9146652 -0.8871118 -0.92070090 -0.3039913 -0.7257107 -0.8683501 -0.7803108
        Salary
1 -0.008588271
2 -0.590968548
3  1.065864161
4  0.755999969
5 -0.032797378</code></pre>
</div>
</div>
<p>I create a combined dataset with the cluster numbers as variables.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#creating df with cluster indices as variable</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>clusterdf <span class="ot">=</span> <span class="fu">as.data.frame</span>(k5<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding cluster indices and creating df4</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">=</span> df2 <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(clusterdf) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(Cricket_Data<span class="sc">$</span>Team) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> <span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Team =</span> <span class="st">"...10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...10`</code></pre>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#structure of df4</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   70 obs. of  10 variables:
 $ Runs    : num  442 393 61 282 510 110 123 12 490 405 ...
 $ Avg     : num  44.2 32.8 12.2 23.5 56.7 ...
 $ SR      : num  154 137.9 107 93.1 204.8 ...
 $ Hundreds: num  0 1 0 0 0 0 0 0 0 0 ...
 $ Fifties : num  5 1 0 1 4 0 0 0 4 4 ...
 $ Fours   : num  31 45 5 20 31 10 8 1 45 41 ...
 $ Sixes   : num  26 9 2 7 52 3 4 0 34 22 ...
 $ Salary  : num  1.719 0.625 0.514 0.344 1.328 ...
 $ cluster : int  3 4 5 5 3 5 5 5 3 1 ...
 $ Team    : chr  "Royal Challengers Bangalore" "Rajasthan Royals" "Royal Challengers Bangalore" "Chennai Super Kings" ...</code></pre>
</div>
</div>
<p>Here are the descriptive statistics for each cluster (data is unscaled).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stby</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df4,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">INDICES =</span> df4<span class="sc">$</span>cluster, <span class="co"># by clusters</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> descr, <span class="co"># descriptive statistics from summarytools</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">transpose =</span> <span class="cn">TRUE</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Non-numerical variable(s) ignored: Team</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Descriptive Statistics  
df4  
Group: cluster = 1  
N: 19  

                   Mean   Std.Dev   Median      Min      Max
-------------- -------- --------- -------- -------- --------
           Avg    31.74      5.73    31.62    22.06    43.00
       cluster     1.00      0.00     1.00     1.00     1.00
       Fifties     2.79      0.92     3.00     1.00     5.00
         Fours    38.42     11.04    41.00    21.00    64.00
      Hundreds     0.00      0.00     0.00     0.00     0.00
          Runs   375.32     74.26   373.00   253.00   529.00
        Salary     0.91      0.66     0.69     0.16     2.34
         Sixes    13.05      5.56    11.00     4.00    25.00
            SR   131.89     10.48   130.86   115.10   151.70

Group: cluster = 2  
N: 17  

                   Mean   Std.Dev   Median      Min      Max
-------------- -------- --------- -------- -------- --------
           Avg    27.85     10.89    26.62    14.60    52.75
       cluster     2.00      0.00     2.00     2.00     2.00
       Fifties     0.41      0.62     0.00     0.00     2.00
         Fours    11.76      5.17    13.00     2.00    19.00
      Hundreds     0.00      0.00     0.00     0.00     0.00
          Runs   150.12     68.37   160.00    63.00   279.00
        Salary     0.52      0.52     0.29     0.03     1.95
         Sixes     7.71      5.76     7.00     1.00    22.00
            SR   148.72     17.69   151.31   125.87   175.00

Group: cluster = 3  
N: 6  

                   Mean   Std.Dev   Median      Min      Max
-------------- -------- --------- -------- -------- --------
           Avg    51.18     16.97    44.43    37.53    83.20
       cluster     3.00      0.00     3.00     3.00     3.00
       Fifties     3.33      1.37     3.50     1.00     5.00
         Fours    32.33      7.89    31.00    22.00    45.00
      Hundreds     0.00      0.00     0.00     0.00     0.00
          Runs   458.00     44.24   465.00   402.00   510.00
        Salary     1.63      0.76     1.72     0.31     2.34
         Sixes    31.83     10.53    28.00    23.00    52.00
            SR   166.85     26.24   158.33   134.62   204.81

Group: cluster = 4  
N: 6  

                   Mean   Std.Dev   Median      Min      Max
-------------- -------- --------- -------- -------- --------
           Avg    46.47     15.31    44.05    32.75    69.20
       cluster     4.00      0.00     4.00     4.00     4.00
       Fifties     3.17      3.13     2.00     0.00     8.00
         Fours    45.50      9.57    47.00    28.00    57.00
      Hundreds     1.00      0.00     1.00     1.00     1.00
          Runs   488.17    130.70   454.50   342.00   692.00
        Salary     1.42      0.87     1.48     0.31     2.66
         Sixes    16.50      5.92    15.50     9.00    25.00
            SR   144.09      7.94   142.66   135.38   157.24

Group: cluster = 5  
N: 22  

                   Mean   Std.Dev   Median     Min      Max
-------------- -------- --------- -------- ------- --------
           Avg    15.37      7.49    16.31    3.60    35.33
       cluster     5.00      0.00     5.00    5.00     5.00
       Fifties     0.23      0.43     0.00    0.00     1.00
         Fours     7.77      6.51     5.50    1.00    20.00
      Hundreds     0.00      0.00     0.00    0.00     0.00
          Runs    94.91     68.50    85.00   12.00   282.00
        Salary     0.89      0.48     0.81    0.07     1.95
         Sixes     3.05      1.91     3.00    0.00     7.00
            SR   109.93     21.24   116.50   63.15   150.00</code></pre>
</div>
</div>
<p>We can observe the means of the produced clusters and check if the high average performance corresponds with higher or lower average salaries. This would help to identify clusters which contain underpaid or overpaid players.</p>
<p>In the given tables, we can observe that Cluster 3 has the top average salary of 1.63. The second highest earning cluster is Cluster 4. We can also observe that these clusters contain the highest performing players since their average performing metrics are the highest among the cluster. The exceptions are SR, where Cluster 2 is performing better than Cluster 4, taking second place, and Fours, where Cluster 1 performs better than Cluster 3, coming second. Otherwise, we can see that they are the top performers and thus the top earners. Their performance in the key metrics is, on average, in the top 3 (even top 2, mostly) and have the highest average salaries. Even their minimums in Avg and SR are as high as average values of most other clusters, if not higher. The 6 players in Cluster 4 are the only ones scoring Hundreds, separating them from the 6 players of Cluster 3. We can therefore identify them as 12 top performers and top earners. Therefore, we can call the Cluster 3 “Top Performers” and Cluster 4 “Hundred Scorers”.</p>
<p>The other cluster is Cluster 1. We can call them as the “Average Player”. They are the second most populous cluster and perform average. Their metrics is in the middle between most of the Clusters, except SR (they are 3rd) and Fours (2nd). We can also identify them as average since they get the average pay. We can see that in the scaled cluster centers, where the closer the value is to 0, the closer it is to the mean.</p>
<p>The remaining two clusters are 2 and 5. Interestingly, we can see that Cluster 2 overperforms Cluster 5 by all metrics but gets the lowest salary on average (0.52 vs 0.89). Not only that, Cluster 5, on average, performs worse than any other cluster but the salary is very close to the pay of Cluster “Average” (0.89 and 0.91). It is also worth noticing that Cluster 2 performs the 2nd best by SR, one of the key metrics Mitra is interested in. All this indicates that Cluster 2 is underpaid. Thus, I call cluster 5 “Overpaid” and Cluster 2 “Underpaid”.</p>
</section>
<section id="parallel-coordinate-plot-for-cluster-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="parallel-coordinate-plot-for-cluster-interpretation">Parallel Coordinate Plot for Cluster interpretation</h2>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>k5centers <span class="ot">=</span> k5<span class="sc">$</span>centers <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co">#ggparcoord</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co">#parcoord</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To better analyze and compare the clusters I use Parallel Coordinate Plot to see the Cluster centers (means) all at the same time. In this plot the higher values of the metrics are, the better. It means that high metrics values should be followed by high salary.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> k5centers,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/PCP of Cluster Centers including Hundreds-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hundreds Variable skews the view a little, so I remove it from the plot but keep in mind that only “Hundred Scorers” cluster (Blue) has players who scored Hundreds.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k5centers, <span class="sc">-</span>Hundreds), <span class="co">#MASS masks select</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/PCP excluding Hundreds-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe that Clusters Top Performers and Hundred Scorers perform generally well and earn higher than average salaries. Cluster Average Player is somewhat in the middle and earns average salary. Most interestingly, Clusters Underpaid and Overpaid on average perform the worst but the Underpaid plays better than the Overpaid by all metrics and even has the second highest SR yet earns the least. This happens while the Overpaid earns as much as Average Player. It should also be noticed that the scaled average salaries of the Clusters Average Player, Top Performers, and Hundred Scorers are in the vicinity of the scaled Avg and SR, whereas the Clusters Underpaid and Overpaid are not. This might again indicate that players are underpaid and overpaid in the respective clusters, on average.</p>
<p>I also show the cluster centers separately side by side.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> k5centers,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/PCP for each cluster spearately-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k5centers, <span class="sc">-</span>Hundreds),</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Centers by Variables without Hundreds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/PCP for each cluster spearately without Hundreds-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>k4centers <span class="ot">=</span> k4<span class="sc">$</span>centers <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>I create Parallel Coordinate Plot to identify the differences when we use 4 clusters instead of 5.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k4centers, <span class="sc">-</span>Hundreds),</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/PCP for Clusters with 4 centers-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we can observe that Cluster Analysis with only 4 centers merges two worst performing Clusters together, so we do not see underpaid players. I, therefore, suggest sticking with 5 clusters.</p>
<p>These are average values, so we might want to look at the individual data.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">=</span> df3 <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(clusterdf) <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> <span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df5, <span class="sc">-</span>Hundreds) <span class="sc">%&gt;%</span> <span class="co">#MASS masks select</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">"cluster"</span>), as.factor) <span class="sc">%&gt;%</span> <span class="co">#needs to factor cluster</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df5, <span class="sc">-</span>Hundreds) <span class="sc">%&gt;%</span> <span class="co">#MASS masks select</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">"cluster"</span>), as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The lines intertwine in some places but generally stay within its cluster. Most intertwining happens in the Salary. There is also some between Clusters 1 and 2 in Avg and SR metrics.</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.factor</span>(clusterdf<span class="sc">$</span><span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> ...<span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="co">#`k5$cluster` is renamed into ...12</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Player, </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> cluster), </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>))) <span class="sc">+</span> <span class="co">#size=5 overrides the size of colored letters in legend</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot of the Players' Avg vs SR clustered"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
• `` -&gt; `...12`</code></pre>
</div>
<div class="cell-output-display">
<p><img src="cluster_ipl_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here we can also observe separation of the key metrics by clusters and that Cluster Underpaid is closer to Average Player than Overpaid Cluster. In other words, it has higher SR and Avg than Overpaid clusters, but their salary does not reflect that.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>I suggest reevaluating the pay of the players from Cluster 2. The Teams might also reconsider the salaries of the players from Cluster 5 who perform the worst but get paid the average rate. The cluster centers showed the average performance of the players from the same subgroups but a more individual evaluation should take place before the final decision.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb68" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Cluster Analysis IPL"</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co">    freeze: auto</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Instroduction</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>Here I explore the performance of the Indian Premier League batsmen in cricket. The dataset includes the popular performance metrics for 92 players: Average, Total Runs, Strike Rate, Hundreds, Fifties, Fours, Sixes, and salaries. In short, the higher the value of the metrics, the better a batsman is. The Average reflects the total number of runs scored divided by the number of innings in a season. The SR is calculated by dividing the number of runs scored by the number of balls faced and then multiplying by 100. It shows if a batsman scores runs at a faster pace. The rest of the metrics reflect the numbers of times a player scored, for example, fifty or more runs per inning. An inning is a team's turn to bat.</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>I am analyzing the correspondence of the players' pay and their performance. I am going to look at SR and Avg. These two metrics should be of critical meaning since they signal the relative performance. In other words, if we compare two player’s SR (Strikes Rate) rather than absolute scores, we can observe their ability to score high (runs per 100 balls faced). This is more clear than absolute numbers of runs, since batsmen have to be called to face the ball, which can skew the final number. The same could be said about Avg.</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Exploration</span></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"The Indian Premier League Supplemental Data.xlsx"</span>, </span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sheet =</span> <span class="st">"Sheet1"</span>, <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, </span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">"skip"</span>, <span class="st">"text"</span>, <span class="st">"text"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>, </span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">"numeric"</span>))</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries for descriptibe stats}</span></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co">#describe()</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools) <span class="co">#descr()</span></span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>Here is a quick preview of the dataset:</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Cricket_Data)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>Here we can see a table of descriptive statistics for the performance metrics:</span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stats}</span></span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a><span class="fu">descr</span>(Cricket_Data[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)],  <span class="co">#without ...1, Player, Team</span></span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries for plotting and wrapping, results = 'hide'}</span></span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>Here I plot the Salary against the Avg.</span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Avg, <span class="at">y=</span>Salary)) <span class="sc">+</span></span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>We can see that generally a higher Avg is associated with higher salary.</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>I now plot SR against the Salary.</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Salary)) <span class="sc">+</span></span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>Here we can observe almost no visual relationship between the two.</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a>I then build a simple correlation matrix to see which metrics are highly correlated with salary:</span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Correlation Matrix for Salary}</span></span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>Cricket_Data[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Salary) <span class="sc">|&gt;</span></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Salary))</span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a>We observe a positive but weak correlation between Salary and most performance metrics. SR, however, has the lowest correlation.</span>
<span id="cb68-99"><a href="#cb68-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-100"><a href="#cb68-100" aria-hidden="true" tabindex="-1"></a>I generate boxplots for both metrics with outliers named, so we can see the distribution of the data and the names of the players who score the highest. The limitation would be that we do not see other players. This can be overcome by sorting the data by our metrics and see who ends up above the mean or another threshold.</span>
<span id="cb68-101"><a href="#cb68-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-102"><a href="#cb68-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Avg boxplot}</span></span>
<span id="cb68-103"><a href="#cb68-103" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-104"><a href="#cb68-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb68-105"><a href="#cb68-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-106"><a href="#cb68-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.4</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb68-107"><a href="#cb68-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(Cricket_Data, Avg<span class="sc">&gt;</span><span class="dv">60</span>), <span class="fu">aes</span>(<span class="at">label =</span> Player)) <span class="sc">+</span></span>
<span id="cb68-108"><a href="#cb68-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Boxplot for Avg"</span>)</span>
<span id="cb68-109"><a href="#cb68-109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-110"><a href="#cb68-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-111"><a href="#cb68-111" aria-hidden="true" tabindex="-1"></a>We can see that these two players have the highest Avg.</span>
<span id="cb68-112"><a href="#cb68-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-113"><a href="#cb68-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{r SR boxplot}</span></span>
<span id="cb68-114"><a href="#cb68-114" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-115"><a href="#cb68-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>SR)) <span class="sc">+</span></span>
<span id="cb68-116"><a href="#cb68-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-117"><a href="#cb68-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">color=</span><span class="st">"black"</span>, <span class="at">size=</span><span class="fl">0.4</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb68-118"><a href="#cb68-118" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="at">data =</span> <span class="fu">subset</span>(Cricket_Data, SR<span class="sc">&gt;</span><span class="dv">180</span>), <span class="fu">aes</span>(<span class="at">label =</span> Player))<span class="sc">+</span></span>
<span id="cb68-119"><a href="#cb68-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Boxplot for SR"</span>)</span>
<span id="cb68-120"><a href="#cb68-120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-121"><a href="#cb68-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-122"><a href="#cb68-122" aria-hidden="true" tabindex="-1"></a>The other two have the highest SR.</span>
<span id="cb68-123"><a href="#cb68-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-124"><a href="#cb68-124" aria-hidden="true" tabindex="-1"></a>I know plot Avg vs SR, to see the distribution of players according to these metrics.</span>
<span id="cb68-125"><a href="#cb68-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-126"><a href="#cb68-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plotting SR vs Avg}</span></span>
<span id="cb68-127"><a href="#cb68-127" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-128"><a href="#cb68-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb68-129"><a href="#cb68-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Player), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-130"><a href="#cb68-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Plot of the Players' Avg vs SR"</span>)</span>
<span id="cb68-131"><a href="#cb68-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-132"><a href="#cb68-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-133"><a href="#cb68-133" aria-hidden="true" tabindex="-1"></a>Here we can identify the players with the highest combination of SR and Avg metrics. The closer the player is to the top right corner, the better performance he has, and reversely the closer he is to the bottom left, the worse their performance is. We can also observe that relatively few players have Avg above 40.</span>
<span id="cb68-134"><a href="#cb68-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-135"><a href="#cb68-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## Clustering</span></span>
<span id="cb68-136"><a href="#cb68-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-137"><a href="#cb68-137" aria-hidden="true" tabindex="-1"></a>I then perform cluster analysis to discover any subgroups within the dataset. I use a clustering method called kmeans, which uses the Euclidean distances to subset our datapoints.</span>
<span id="cb68-138"><a href="#cb68-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-139"><a href="#cb68-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries for clustering}</span></span>
<span id="cb68-140"><a href="#cb68-140" aria-hidden="true" tabindex="-1"></a><span class="co">#library(tidyverse)  # data manipulation</span></span>
<span id="cb68-141"><a href="#cb68-141" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)    <span class="co"># clustering algorithms</span></span>
<span id="cb68-142"><a href="#cb68-142" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra) <span class="co"># clustering algorithms &amp; visualization (fviz...)</span></span>
<span id="cb68-143"><a href="#cb68-143" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-144"><a href="#cb68-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-145"><a href="#cb68-145" aria-hidden="true" tabindex="-1"></a>I remove the variables Team and "...1" in the data.</span>
<span id="cb68-146"><a href="#cb68-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-149"><a href="#cb68-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-150"><a href="#cb68-150" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">select</span>(Cricket_Data, <span class="sc">-</span>Team, <span class="sc">-</span><span class="st">"...1"</span>)</span>
<span id="cb68-151"><a href="#cb68-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-152"><a href="#cb68-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-153"><a href="#cb68-153" aria-hidden="true" tabindex="-1"></a>I set the Players' names as rownames to label the datapoints for better vizualization.</span>
<span id="cb68-154"><a href="#cb68-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-157"><a href="#cb68-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-158"><a href="#cb68-158" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">=</span> <span class="fu">column_to_rownames</span>(df, <span class="st">"Player"</span>)</span>
<span id="cb68-159"><a href="#cb68-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-160"><a href="#cb68-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-161"><a href="#cb68-161" aria-hidden="true" tabindex="-1"></a>I check clustering without scaling the data first.</span>
<span id="cb68-162"><a href="#cb68-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-163"><a href="#cb68-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r checking clusters without scaling}</span></span>
<span id="cb68-164"><a href="#cb68-164" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-165"><a href="#cb68-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-166"><a href="#cb68-166" aria-hidden="true" tabindex="-1"></a>k4<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df2, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb68-167"><a href="#cb68-167" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k4<span class="fl">.2</span>, <span class="at">data =</span> df2)</span>
<span id="cb68-168"><a href="#cb68-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-169"><a href="#cb68-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-170"><a href="#cb68-170" aria-hidden="true" tabindex="-1"></a>As we can see, unscaled data overlaps signficantly.</span>
<span id="cb68-171"><a href="#cb68-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-172"><a href="#cb68-172" aria-hidden="true" tabindex="-1"></a>I standardize the data for better clustering using scale() function.</span>
<span id="cb68-173"><a href="#cb68-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-174"><a href="#cb68-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r scaling}</span></span>
<span id="cb68-175"><a href="#cb68-175" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(df2))</span>
<span id="cb68-176"><a href="#cb68-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-177"><a href="#cb68-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-178"><a href="#cb68-178" aria-hidden="true" tabindex="-1"></a>I check the scaling:</span>
<span id="cb68-179"><a href="#cb68-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-180"><a href="#cb68-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r checking scale}</span></span>
<span id="cb68-181"><a href="#cb68-181" aria-hidden="true" tabindex="-1"></a><span class="co">#check scaling. Mean should be 0 and Std 1.</span></span>
<span id="cb68-182"><a href="#cb68-182" aria-hidden="true" tabindex="-1"></a><span class="fu">descr</span>(df3, </span>
<span id="cb68-183"><a href="#cb68-183" aria-hidden="true" tabindex="-1"></a>      <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb68-184"><a href="#cb68-184" aria-hidden="true" tabindex="-1"></a>      <span class="at">transpose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-185"><a href="#cb68-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-186"><a href="#cb68-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-187"><a href="#cb68-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r kmeans clustering with 2 centers}</span></span>
<span id="cb68-188"><a href="#cb68-188" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">2</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb68-189"><a href="#cb68-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-190"><a href="#cb68-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-191"><a href="#cb68-191" aria-hidden="true" tabindex="-1"></a>I visualize initial kmeans clustering with 2 clusters.</span>
<span id="cb68-192"><a href="#cb68-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-195"><a href="#cb68-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-196"><a href="#cb68-196" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k2, <span class="at">data =</span> df3)</span>
<span id="cb68-197"><a href="#cb68-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-198"><a href="#cb68-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-199"><a href="#cb68-199" aria-hidden="true" tabindex="-1"></a>I plot Clusters by Teams to see if it produces any insight.</span>
<span id="cb68-200"><a href="#cb68-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-201"><a href="#cb68-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r clustering with Teams}</span></span>
<span id="cb68-202"><a href="#cb68-202" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(<span class="at">object =</span> <span class="fu">list</span>(<span class="at">data =</span> df3, </span>
<span id="cb68-203"><a href="#cb68-203" aria-hidden="true" tabindex="-1"></a>                           <span class="at">cluster =</span> Cricket_Data<span class="sc">$</span>Team),</span>
<span id="cb68-204"><a href="#cb68-204" aria-hidden="true" tabindex="-1"></a>             <span class="at">geom =</span> <span class="st">"point"</span>,</span>
<span id="cb68-205"><a href="#cb68-205" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.clust.cent =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-206"><a href="#cb68-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-207"><a href="#cb68-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-208"><a href="#cb68-208" aria-hidden="true" tabindex="-1"></a>We can see that Players cannot be meaningfully clustered by Teams. That is, the teams do not differ from each other based on the metrics presented. </span>
<span id="cb68-209"><a href="#cb68-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-210"><a href="#cb68-210" aria-hidden="true" tabindex="-1"></a>I perform Elbow method to identify optimal number of Clusters.</span>
<span id="cb68-211"><a href="#cb68-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-212"><a href="#cb68-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r algo for Elbow method, echo=FALSE, results='hide'}</span></span>
<span id="cb68-213"><a href="#cb68-213" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-214"><a href="#cb68-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-215"><a href="#cb68-215" aria-hidden="true" tabindex="-1"></a><span class="co"># function to compute total within-cluster sum of square </span></span>
<span id="cb68-216"><a href="#cb68-216" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb68-217"><a href="#cb68-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kmeans</span>(df3, k, <span class="at">nstart =</span> <span class="dv">25</span> )<span class="sc">$</span>tot.withinss</span>
<span id="cb68-218"><a href="#cb68-218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-219"><a href="#cb68-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-220"><a href="#cb68-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute and plot wss for k = 1 to k = 15</span></span>
<span id="cb68-221"><a href="#cb68-221" aria-hidden="true" tabindex="-1"></a>k.values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb68-222"><a href="#cb68-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-223"><a href="#cb68-223" aria-hidden="true" tabindex="-1"></a><span class="co"># extract wss for 2-15 clusters</span></span>
<span id="cb68-224"><a href="#cb68-224" aria-hidden="true" tabindex="-1"></a>wss_values <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(k.values, wss)</span>
<span id="cb68-225"><a href="#cb68-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-226"><a href="#cb68-226" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k.values, wss_values,</span>
<span id="cb68-227"><a href="#cb68-227" aria-hidden="true" tabindex="-1"></a>       <span class="at">type=</span><span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">frame =</span> <span class="cn">FALSE</span>, </span>
<span id="cb68-228"><a href="#cb68-228" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">"Number of clusters K"</span>,</span>
<span id="cb68-229"><a href="#cb68-229" aria-hidden="true" tabindex="-1"></a>       <span class="at">ylab=</span><span class="st">"Total within-clusters sum of squares"</span>)</span>
<span id="cb68-230"><a href="#cb68-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-231"><a href="#cb68-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-232"><a href="#cb68-232" aria-hidden="true" tabindex="-1"></a>I use factoextra functions for better visualization.</span>
<span id="cb68-233"><a href="#cb68-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-234"><a href="#cb68-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Elbow Method with fviz_nbclust}</span></span>
<span id="cb68-235"><a href="#cb68-235" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb68-236"><a href="#cb68-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-237"><a href="#cb68-237" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df3, kmeans, <span class="at">method =</span> <span class="st">"wss"</span>) <span class="sc">+</span></span>
<span id="cb68-238"><a href="#cb68-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">190</span>, </span>
<span id="cb68-239"><a href="#cb68-239" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb68-240"><a href="#cb68-240" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb68-241"><a href="#cb68-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">230</span>, </span>
<span id="cb68-242"><a href="#cb68-242" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb68-243"><a href="#cb68-243" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"brown"</span>)</span>
<span id="cb68-244"><a href="#cb68-244" aria-hidden="true" tabindex="-1"></a><span class="co">#should check if k=5 is good too</span></span>
<span id="cb68-245"><a href="#cb68-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-246"><a href="#cb68-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-247"><a href="#cb68-247" aria-hidden="true" tabindex="-1"></a>This chart shows that Total Within Sum of Squares drop rate decreases after 4 and even more so after 5 clusters. We can evaluate both cases and use Silhouette Method for further investigation.</span>
<span id="cb68-248"><a href="#cb68-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-251"><a href="#cb68-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-252"><a href="#cb68-252" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">4</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb68-253"><a href="#cb68-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-254"><a href="#cb68-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-255"><a href="#cb68-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Plot for 4 Clusters with fviz}</span></span>
<span id="cb68-256"><a href="#cb68-256" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k4, <span class="at">data =</span> df3)</span>
<span id="cb68-257"><a href="#cb68-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-258"><a href="#cb68-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-259"><a href="#cb68-259" aria-hidden="true" tabindex="-1"></a>Clusters are almost not overlapping. Cluster 1 is quite big compared to others.</span>
<span id="cb68-260"><a href="#cb68-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-261"><a href="#cb68-261" aria-hidden="true" tabindex="-1"></a>Here are the cluster centers (means) and sizes of clusters.</span>
<span id="cb68-262"><a href="#cb68-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-265"><a href="#cb68-265" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-266"><a href="#cb68-266" aria-hidden="true" tabindex="-1"></a>k4<span class="sc">$</span>centers</span>
<span id="cb68-267"><a href="#cb68-267" aria-hidden="true" tabindex="-1"></a>k4<span class="sc">$</span>size</span>
<span id="cb68-268"><a href="#cb68-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-269"><a href="#cb68-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-270"><a href="#cb68-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-271"><a href="#cb68-271" aria-hidden="true" tabindex="-1"></a>Here is the plot for Average Silhouette Method. ASM determines how well each object lies within its cluster. A high average silhouette width signals a good clustering.</span>
<span id="cb68-272"><a href="#cb68-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-273"><a href="#cb68-273" aria-hidden="true" tabindex="-1"></a><span class="in">```{r silhouette with fviz}</span></span>
<span id="cb68-274"><a href="#cb68-274" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(df3, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>) <span class="sc">+</span></span>
<span id="cb68-275"><a href="#cb68-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">5</span>, </span>
<span id="cb68-276"><a href="#cb68-276" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb68-277"><a href="#cb68-277" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>)</span>
<span id="cb68-278"><a href="#cb68-278" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(v = 5, col = "red", lty = "dashed")</span></span>
<span id="cb68-279"><a href="#cb68-279" aria-hidden="true" tabindex="-1"></a><span class="co">#seems k=5 is the second highest </span></span>
<span id="cb68-280"><a href="#cb68-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-281"><a href="#cb68-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-282"><a href="#cb68-282" aria-hidden="true" tabindex="-1"></a>According to the ASM plot, k=5 should be more optimal than k=4. I perform a new cluster analysis using 5 centers.</span>
<span id="cb68-283"><a href="#cb68-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-284"><a href="#cb68-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r k5 analysis with 5 clusters}</span></span>
<span id="cb68-285"><a href="#cb68-285" aria-hidden="true" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df3, <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb68-286"><a href="#cb68-286" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(k5, <span class="at">data =</span> df3)</span>
<span id="cb68-287"><a href="#cb68-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-288"><a href="#cb68-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-289"><a href="#cb68-289" aria-hidden="true" tabindex="-1"></a>Here are the Cluster centers which we can interpret as means for each cluster (data is scaled).</span>
<span id="cb68-290"><a href="#cb68-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-293"><a href="#cb68-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-294"><a href="#cb68-294" aria-hidden="true" tabindex="-1"></a>k5<span class="sc">$</span>centers</span>
<span id="cb68-295"><a href="#cb68-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-296"><a href="#cb68-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-297"><a href="#cb68-297" aria-hidden="true" tabindex="-1"></a>I create a combined dataset with the cluster numbers as variables.</span>
<span id="cb68-298"><a href="#cb68-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-299"><a href="#cb68-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creating df with cluster indices as variable}</span></span>
<span id="cb68-300"><a href="#cb68-300" aria-hidden="true" tabindex="-1"></a><span class="co">#creating df with cluster indices as variable</span></span>
<span id="cb68-301"><a href="#cb68-301" aria-hidden="true" tabindex="-1"></a>clusterdf <span class="ot">=</span> <span class="fu">as.data.frame</span>(k5<span class="sc">$</span>cluster)</span>
<span id="cb68-302"><a href="#cb68-302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-303"><a href="#cb68-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-304"><a href="#cb68-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Adding cluster indices and creating df4}</span></span>
<span id="cb68-305"><a href="#cb68-305" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding cluster indices and creating df4</span></span>
<span id="cb68-306"><a href="#cb68-306" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">=</span> df2 <span class="sc">%&gt;%</span> </span>
<span id="cb68-307"><a href="#cb68-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(clusterdf) <span class="sc">%&gt;%</span> </span>
<span id="cb68-308"><a href="#cb68-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(Cricket_Data<span class="sc">$</span>Team) <span class="sc">%&gt;%</span> </span>
<span id="cb68-309"><a href="#cb68-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> <span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb68-310"><a href="#cb68-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Team =</span> <span class="st">"...10"</span>)</span>
<span id="cb68-311"><a href="#cb68-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-312"><a href="#cb68-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-313"><a href="#cb68-313" aria-hidden="true" tabindex="-1"></a><span class="in">```{r structure of df4}</span></span>
<span id="cb68-314"><a href="#cb68-314" aria-hidden="true" tabindex="-1"></a><span class="co">#structure of df4</span></span>
<span id="cb68-315"><a href="#cb68-315" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df4)</span>
<span id="cb68-316"><a href="#cb68-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-317"><a href="#cb68-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-318"><a href="#cb68-318" aria-hidden="true" tabindex="-1"></a>Here are the descriptive statistics for each cluster (data is unscaled).</span>
<span id="cb68-319"><a href="#cb68-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-320"><a href="#cb68-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Stats for Clusters}</span></span>
<span id="cb68-321"><a href="#cb68-321" aria-hidden="true" tabindex="-1"></a><span class="fu">stby</span>(</span>
<span id="cb68-322"><a href="#cb68-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df4,</span>
<span id="cb68-323"><a href="#cb68-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">INDICES =</span> df4<span class="sc">$</span>cluster, <span class="co"># by clusters</span></span>
<span id="cb68-324"><a href="#cb68-324" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN =</span> descr, <span class="co"># descriptive statistics from summarytools</span></span>
<span id="cb68-325"><a href="#cb68-325" aria-hidden="true" tabindex="-1"></a>  <span class="at">stats =</span> <span class="fu">c</span>(<span class="st">"mean"</span>, <span class="st">"sd"</span>,<span class="st">"med"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>), </span>
<span id="cb68-326"><a href="#cb68-326" aria-hidden="true" tabindex="-1"></a>  <span class="at">transpose =</span> <span class="cn">TRUE</span></span>
<span id="cb68-327"><a href="#cb68-327" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-328"><a href="#cb68-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-329"><a href="#cb68-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-330"><a href="#cb68-330" aria-hidden="true" tabindex="-1"></a>We can observe the means of the produced clusters and check if the high average performance corresponds with higher or lower average salaries. This would help to identify clusters which contain underpaid or overpaid players.</span>
<span id="cb68-331"><a href="#cb68-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-332"><a href="#cb68-332" aria-hidden="true" tabindex="-1"></a>In the given tables, we can observe that Cluster 3 has the top average salary of 1.63. The second highest earning cluster is Cluster 4. We can also observe that these clusters contain the highest performing players since their average performing metrics are the highest among the cluster. The exceptions are SR, where Cluster 2 is performing better than Cluster 4, taking second place, and Fours, where Cluster 1 performs better than Cluster 3, coming second. Otherwise, we can see that they are the top performers and thus the top earners. Their performance in the key metrics is, on average, in the top 3 (even top 2, mostly) and have the highest average salaries. Even their minimums in Avg and SR are as high as average values of most other clusters, if not higher. The 6 players in Cluster 4 are the only ones scoring Hundreds, separating them from the 6 players of Cluster 3. We can therefore identify them as 12 top performers and top earners. Therefore, we can call the Cluster 3 “Top Performers” and Cluster 4 “Hundred Scorers”.</span>
<span id="cb68-333"><a href="#cb68-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-334"><a href="#cb68-334" aria-hidden="true" tabindex="-1"></a>The other cluster is Cluster 1. We can call them as the “Average Player”. They are the second most populous cluster and perform average. Their metrics is in the middle between most of the Clusters, except SR (they are 3rd) and Fours (2nd). We can also identify them as average since they get the average pay. We can see that in the scaled cluster centers, where the closer the value is to 0, the closer it is to the mean.</span>
<span id="cb68-335"><a href="#cb68-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-336"><a href="#cb68-336" aria-hidden="true" tabindex="-1"></a>The remaining two clusters are 2 and 5. Interestingly, we can see that Cluster 2 overperforms Cluster 5 by all metrics but gets the lowest salary on average (0.52 vs 0.89). Not only that, Cluster 5, on average, performs worse than any other cluster but the salary is very close to the pay of Cluster “Average” (0.89 and 0.91). It is also worth noticing that Cluster 2 performs the 2nd best by SR, one of the key metrics Mitra is interested in. All this indicates that Cluster 2 is underpaid. Thus, I call cluster 5 “Overpaid” and Cluster 2 “Underpaid”.</span>
<span id="cb68-337"><a href="#cb68-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-338"><a href="#cb68-338" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parallel Coordinate Plot for Cluster interpretation</span></span>
<span id="cb68-339"><a href="#cb68-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-340"><a href="#cb68-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creating cluster center df called k5centers}</span></span>
<span id="cb68-341"><a href="#cb68-341" aria-hidden="true" tabindex="-1"></a>k5centers <span class="ot">=</span> k5<span class="sc">$</span>centers <span class="sc">%&gt;%</span> </span>
<span id="cb68-342"><a href="#cb68-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-343"><a href="#cb68-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"cluster"</span>)</span>
<span id="cb68-344"><a href="#cb68-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-345"><a href="#cb68-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-346"><a href="#cb68-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries for parallel coordinate plots, results='hide', message=FALSE, warning=FALSE}</span></span>
<span id="cb68-347"><a href="#cb68-347" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) <span class="co">#ggparcoord</span></span>
<span id="cb68-348"><a href="#cb68-348" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb68-349"><a href="#cb68-349" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co">#parcoord</span></span>
<span id="cb68-350"><a href="#cb68-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-351"><a href="#cb68-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-352"><a href="#cb68-352" aria-hidden="true" tabindex="-1"></a>To better analyze and compare the clusters I use Parallel Coordinate Plot to see the Cluster centers (means) all at the same time. In this plot the higher values of the metrics are, the better. It means that high metrics values should be followed by high salary.</span>
<span id="cb68-353"><a href="#cb68-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-354"><a href="#cb68-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCP of Cluster Centers including Hundreds}</span></span>
<span id="cb68-355"><a href="#cb68-355" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> k5centers,</span>
<span id="cb68-356"><a href="#cb68-356" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb68-357"><a href="#cb68-357" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-358"><a href="#cb68-358" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-359"><a href="#cb68-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-360"><a href="#cb68-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb68-361"><a href="#cb68-361" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb68-362"><a href="#cb68-362" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb68-363"><a href="#cb68-363" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb68-364"><a href="#cb68-364" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb68-365"><a href="#cb68-365" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb68-366"><a href="#cb68-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span>
<span id="cb68-367"><a href="#cb68-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-368"><a href="#cb68-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-369"><a href="#cb68-369" aria-hidden="true" tabindex="-1"></a>Hundreds Variable skews the view a little, so I remove it from the plot but keep in mind that only "Hundred Scorers" cluster (Blue) has players who scored Hundreds.</span>
<span id="cb68-370"><a href="#cb68-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-371"><a href="#cb68-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCP excluding Hundreds}</span></span>
<span id="cb68-372"><a href="#cb68-372" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k5centers, <span class="sc">-</span>Hundreds), <span class="co">#MASS masks select</span></span>
<span id="cb68-373"><a href="#cb68-373" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb68-374"><a href="#cb68-374" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-375"><a href="#cb68-375" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-376"><a href="#cb68-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-377"><a href="#cb68-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb68-378"><a href="#cb68-378" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb68-379"><a href="#cb68-379" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb68-380"><a href="#cb68-380" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb68-381"><a href="#cb68-381" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb68-382"><a href="#cb68-382" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb68-383"><a href="#cb68-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span>
<span id="cb68-384"><a href="#cb68-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-385"><a href="#cb68-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-386"><a href="#cb68-386" aria-hidden="true" tabindex="-1"></a>We can observe that Clusters Top Performers and Hundred Scorers perform generally well and earn higher than average salaries. Cluster Average Player is somewhat in the middle and earns average salary. Most interestingly, Clusters Underpaid and Overpaid on average perform the worst but the Underpaid plays better than the Overpaid by all metrics and even has the second highest SR yet earns the least. This happens while the Overpaid earns as much as Average Player. It should also be noticed that the scaled average salaries of the Clusters Average Player, Top Performers, and Hundred Scorers are in the vicinity of the scaled Avg and SR, whereas the Clusters Underpaid and Overpaid are not. This might again indicate that players are underpaid and overpaid in the respective clusters, on average.</span>
<span id="cb68-387"><a href="#cb68-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-388"><a href="#cb68-388" aria-hidden="true" tabindex="-1"></a>I also show the cluster centers separately side by side.</span>
<span id="cb68-389"><a href="#cb68-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-390"><a href="#cb68-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCP for each cluster spearately}</span></span>
<span id="cb68-391"><a href="#cb68-391" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> k5centers,</span>
<span id="cb68-392"><a href="#cb68-392" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>),</span>
<span id="cb68-393"><a href="#cb68-393" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-394"><a href="#cb68-394" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-395"><a href="#cb68-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb68-396"><a href="#cb68-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Centers by Variables"</span>)</span>
<span id="cb68-397"><a href="#cb68-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-398"><a href="#cb68-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-399"><a href="#cb68-399" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCP for each cluster spearately without Hundreds}</span></span>
<span id="cb68-400"><a href="#cb68-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k5centers, <span class="sc">-</span>Hundreds),</span>
<span id="cb68-401"><a href="#cb68-401" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb68-402"><a href="#cb68-402" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-403"><a href="#cb68-403" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-404"><a href="#cb68-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb68-405"><a href="#cb68-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Centers by Variables without Hundreds"</span>)</span>
<span id="cb68-406"><a href="#cb68-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-407"><a href="#cb68-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-408"><a href="#cb68-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-411"><a href="#cb68-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-412"><a href="#cb68-412" aria-hidden="true" tabindex="-1"></a>k4centers <span class="ot">=</span> k4<span class="sc">$</span>centers <span class="sc">%&gt;%</span> </span>
<span id="cb68-413"><a href="#cb68-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb68-414"><a href="#cb68-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"cluster"</span>)</span>
<span id="cb68-415"><a href="#cb68-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-416"><a href="#cb68-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-417"><a href="#cb68-417" aria-hidden="true" tabindex="-1"></a>I create Parallel Coordinate Plot to identify the differences when we use 4 clusters instead of 5.</span>
<span id="cb68-418"><a href="#cb68-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-419"><a href="#cb68-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r PCP for Clusters with 4 centers}</span></span>
<span id="cb68-420"><a href="#cb68-420" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">select</span>(k4centers, <span class="sc">-</span>Hundreds),</span>
<span id="cb68-421"><a href="#cb68-421" aria-hidden="true" tabindex="-1"></a>           <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>),</span>
<span id="cb68-422"><a href="#cb68-422" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-423"><a href="#cb68-423" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-424"><a href="#cb68-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb68-425"><a href="#cb68-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span>
<span id="cb68-426"><a href="#cb68-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-427"><a href="#cb68-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-428"><a href="#cb68-428" aria-hidden="true" tabindex="-1"></a>Here we can observe that Cluster Analysis with only 4 centers merges two worst performing Clusters together, so we do not see underpaid players. I, therefore, suggest sticking with 5 clusters.</span>
<span id="cb68-429"><a href="#cb68-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-430"><a href="#cb68-430" aria-hidden="true" tabindex="-1"></a>These are average values, so we might want to look at the individual data.</span>
<span id="cb68-431"><a href="#cb68-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-434"><a href="#cb68-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-435"><a href="#cb68-435" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">=</span> df3 <span class="sc">%&gt;%</span> </span>
<span id="cb68-436"><a href="#cb68-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(clusterdf) <span class="sc">%&gt;%</span> </span>
<span id="cb68-437"><a href="#cb68-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> <span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>)</span>
<span id="cb68-438"><a href="#cb68-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-439"><a href="#cb68-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-440"><a href="#cb68-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-443"><a href="#cb68-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-444"><a href="#cb68-444" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df5, <span class="sc">-</span>Hundreds) <span class="sc">%&gt;%</span> <span class="co">#MASS masks select</span></span>
<span id="cb68-445"><a href="#cb68-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">"cluster"</span>), as.factor) <span class="sc">%&gt;%</span> <span class="co">#needs to factor cluster</span></span>
<span id="cb68-446"><a href="#cb68-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb68-447"><a href="#cb68-447" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-448"><a href="#cb68-448" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-449"><a href="#cb68-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb68-450"><a href="#cb68-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb68-451"><a href="#cb68-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span>
<span id="cb68-452"><a href="#cb68-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-453"><a href="#cb68-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-456"><a href="#cb68-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-457"><a href="#cb68-457" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(df5, <span class="sc">-</span>Hundreds) <span class="sc">%&gt;%</span> <span class="co">#MASS masks select</span></span>
<span id="cb68-458"><a href="#cb68-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(<span class="st">"cluster"</span>), as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb68-459"><a href="#cb68-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb68-460"><a href="#cb68-460" aria-hidden="true" tabindex="-1"></a>           <span class="at">groupColumn =</span> <span class="st">"cluster"</span>,</span>
<span id="cb68-461"><a href="#cb68-461" aria-hidden="true" tabindex="-1"></a>           <span class="at">scale =</span> <span class="st">"globalminmax"</span>) <span class="sc">+</span></span>
<span id="cb68-462"><a href="#cb68-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb68-463"><a href="#cb68-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"black"</span>)) <span class="sc">+</span></span>
<span id="cb68-464"><a href="#cb68-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> cluster) <span class="sc">+</span></span>
<span id="cb68-465"><a href="#cb68-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Parallel Coordinate Plot of Cluster Centers by Variables"</span>)</span>
<span id="cb68-466"><a href="#cb68-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-467"><a href="#cb68-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-468"><a href="#cb68-468" aria-hidden="true" tabindex="-1"></a>The lines intertwine in some places but generally stay within its cluster. Most intertwining happens in the Salary. There is also some between Clusters 1 and 2 in Avg and SR metrics.</span>
<span id="cb68-469"><a href="#cb68-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-472"><a href="#cb68-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb68-473"><a href="#cb68-473" aria-hidden="true" tabindex="-1"></a>Cricket_Data <span class="sc">%&gt;%</span> </span>
<span id="cb68-474"><a href="#cb68-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">as.factor</span>(clusterdf<span class="sc">$</span><span class="st">`</span><span class="at">k5$cluster</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-475"><a href="#cb68-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cluster =</span> ...<span class="dv">12</span>) <span class="sc">%&gt;%</span> <span class="co">#`k5$cluster` is renamed into ...12</span></span>
<span id="cb68-476"><a href="#cb68-476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>SR, <span class="at">y=</span>Avg)) <span class="sc">+</span></span>
<span id="cb68-477"><a href="#cb68-477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> Player, </span>
<span id="cb68-478"><a href="#cb68-478" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> cluster), </span>
<span id="cb68-479"><a href="#cb68-479" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb68-480"><a href="#cb68-480" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb68-481"><a href="#cb68-481" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Average Player"</span>, </span>
<span id="cb68-482"><a href="#cb68-482" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Underpaid"</span>, </span>
<span id="cb68-483"><a href="#cb68-483" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Top Performers"</span>, </span>
<span id="cb68-484"><a href="#cb68-484" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Hundred Scorers"</span>,</span>
<span id="cb68-485"><a href="#cb68-485" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Overpaid"</span>)) <span class="sc">+</span></span>
<span id="cb68-486"><a href="#cb68-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>))) <span class="sc">+</span> <span class="co">#size=5 overrides the size of colored letters in legend</span></span>
<span id="cb68-487"><a href="#cb68-487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Plot of the Players' Avg vs SR clustered"</span>)</span>
<span id="cb68-488"><a href="#cb68-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb68-489"><a href="#cb68-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-490"><a href="#cb68-490" aria-hidden="true" tabindex="-1"></a>Here we can also observe separation of the key metrics by clusters and that Cluster Underpaid is closer to Average Player than Overpaid Cluster. In other words, it has higher SR and Avg than Overpaid clusters, but their salary does not reflect that.</span>
<span id="cb68-491"><a href="#cb68-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-492"><a href="#cb68-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb68-493"><a href="#cb68-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-494"><a href="#cb68-494" aria-hidden="true" tabindex="-1"></a>I suggest reevaluating the pay of the players from Cluster 2. The Teams might also reconsider the salaries of the players from Cluster 5 who perform the worst but get paid the average rate. The cluster centers showed the average performance of the players from the same subgroups but a more individual evaluation should take place before the final decision.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>